#!/usr/bin/python

import scanner

target_url = "http://192.168.44.101/dvwa/"
links_to_ignore = ["http://192.168.44.101/dvwa/logout.php"]

data_dict = {"username": "admin", "password": "password", "Login": "submit"}

vuln_scanner = scanner.Scanner(target_url, links_to_ignore)
vuln_scanner.session.post("http://192.168.44.101/dvwa/login.php", data=data_dict)

vuln_scanner.crawl()
vuln_scanner.run_scanner()

# Testing forms
# forms = vuln_scanner.extract_forms("http://192.168.44.101/dvwa/vulnerabilities/xss_r/")
# print forms
# response = vuln_scanner.test_xss_in_form(forms[0], "http://192.168.44.101/dvwa/vulnerabilities/xss_r/")
# print response
# response = vuln_scanner.test_sql_injection_in_form(forms[0], "http://192.168.44.101/dvwa/vulnerabilities/sqli/")
# print response
# response = vuln_scanner.test_command_injection_in_form(forms[0], "http://192.168.44.101/dvwa/vulnerabilities/command/")
# print response
# response = vuln_scanner.test_csrf_in_form(forms[0], "http://192.168.44.101/dvwa/vulnerabilities/csrf/")
# print response

# Testing links
# response = vuln_scanner.test_xss_in_link("http://192.168.44.101/dvwa/vulnerabilities/xss_r/?name=")
# print response
# response = vuln_scanner.test_sql_injection_in_link("http://192.168.44.101/dvwa/vulnerabilities/sqli/?id=")
# print response
# response = vuln_scanner.test_command_injection_in_link("http://192.168.44.101/dvwa/vulnerabilities/command/?cmd=")
# print response
# response = vuln_scanner.test_lfi_in_link("http://192.168.44.101/dvwa/vulnerabilities/fi/?page=")
# print response
